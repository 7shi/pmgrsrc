--- lib/iconv_open2.h.orig	Sun Oct  4 21:14:39 2009
+++ lib/iconv_open2.h	Sun Oct  4 21:16:31 2009
@@ -79,9 +79,11 @@
   cd->hooks.wc_hook = NULL;
   cd->hooks.data = NULL;
   #endif
+  #if HAVE_WCRTOMB || HAVE_MBRTOWC
   /* Initialize additional fields. */
   if (from_wchar != to_wchar) {
     struct wchar_conv_struct * wcd = (struct wchar_conv_struct *) cd;
     memset(&wcd->state,'\0',sizeof(mbstate_t));
   }
+  #endif
   /* Done. */
